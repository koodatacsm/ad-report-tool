<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å»£å‘Šé€±å ±ç”Ÿæˆå°å·¥å…· v30.0 - ç°¡ç´„ç‰ˆ</title>
    <style>
        :root { --g-blue: #1a73e8; --g-gray: #5f6368; --bg: #f8f9fa; --border: #dadce0; --success: #34a853; --danger: #d93025; --accent: #673ab7; --warning: #fbc02d; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; height: 100vh; }
        header { background: white; padding: 12px 24px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 2px rgba(0,0,0,0.1); z-index: 100; }
        header h1 { margin: 0; font-size: 18px; color: var(--g-blue); }
        .update-date { font-size: 10px; color: #9aa0a6; font-weight: normal; margin-top: 4px; display: block; }
        main { display: flex; flex: 1; padding: 20px; gap: 20px; overflow: hidden; }
        .card { background: white; border-radius: 8px; border: 1px solid var(--border); display: flex; flex-direction: column; flex: 1; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .card-header { padding: 12px 20px; border-bottom: 1px solid var(--border); background: #f1f3f4; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .content { padding: 20px; overflow-y: auto; flex: 1; }
        label { display: block; font-size: 11px; color: var(--g-gray); margin-bottom: 4px; font-weight: bold; text-transform: uppercase; }
        input[type="text"], input[type="date"], textarea, select { width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 4px; box-sizing: border-box; font-size: 13px; }
        .import-box { background: #fffde7; border: 1px dashed #fbc02d; padding: 12px; border-radius: 4px; margin-bottom: 15px; }
        .platform-selector { display: flex; flex-wrap: wrap; gap: 10px; padding: 8px 0; }
        .platform-item { display: flex; align-items: center; font-size: 12px; cursor: pointer; color: var(--g-gray); }
        .platform-item input { margin-right: 4px; width: auto; }
        .metric-selector { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; background: #fff; padding: 10px; border: 1px solid var(--border); border-radius: 4px; margin-bottom: 10px; }
        .metric-item { display: flex; align-items: center; font-size: 12px; cursor: pointer; color: var(--g-gray); }
        .metric-item input { width: auto; margin-right: 6px; }
        .builder-box { background: #e8f0fe; padding: 15px; border-radius: 6px; border: 1px solid #c1d5fa; margin-top: 15px; }
        .stage-box { background: #fff; padding: 10px; border: 1px solid var(--border); border-radius: 4px; margin-top: 10px; }
        .custom-note-box { margin: 15px 0; padding: 10px; border: 1px dashed var(--g-blue); border-radius: 6px; background: #f0f7ff; }
        #preview { white-space: pre-wrap; font-size: 13px; line-height: 1.6; color: #3c4043; background: white; padding: 20px; border-radius: 4px; border: 1px solid #ddd; min-height: 550px; }
        .btn { background: var(--g-blue); color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 12px; }
        .btn-add { background: var(--accent); border-radius: 20px; flex: 1; margin-top: 8px; }
        .btn-outline { background: white; color: var(--g-gray); border: 1px solid var(--border); font-size: 11px; padding: 4px 8px; }
        .hidden { display: none; }
        
        /* Modal Styles */
        .modal { display: none; position: fixed; z-index: 200; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 800px; border-radius: 8px; max-height: 80vh; display: flex; flex-direction: column; }
        .history-list { overflow-y: auto; flex: 1; margin-top: 10px; }
        .history-item { padding: 12px; border-bottom: 1px solid #eee; cursor: pointer; display: grid; grid-template-columns: 100px 150px 1fr 50px; align-items: center; }
        .history-item:hover { background-color: #f5f5f5; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <header>
        <div>
            <h1>å»£å‘Šé€±å ±ç”Ÿæˆå°å·¥å…· v30.0</h1>
            <span class="update-date">æœ€å¾Œæ›´æ–°ï¼š2026/01/22 (ç°¡ç´„æ´å¯Ÿç‰ˆ)</span>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
            <button class="btn" style="background:var(--accent)" onclick="openHistory()">ğŸ“œ æ­·å²ç´€éŒ„</button>
            <button class="btn btn-outline" onclick="resetDefault()">ğŸ”„ é‡ç½®</button>
            <select id="templateLoader" style="width: 150px;" onchange="loadTemplate()"><option value="">é¸æ“‡å®¢æˆ¶ç¯„æœ¬</option></select>
            <button class="btn btn-outline" onclick="exportTemplates()">ğŸ”— åŒ¯å‡º</button>
            <button class="btn btn-outline" onclick="importTemplates()">ğŸ“¥ åŒ¯å…¥</button>
        </div>
    </header>
    <main>
        <div class="card">
            <div class="card-header">æ•¸æ“šåŒ¯å…¥èˆ‡ç­–ç•¥ç”Ÿæˆ <button class="btn" style="background:var(--success)" onclick="saveTemplate()">ğŸ’¾ å„²å­˜ç¯„æœ¬</button></div>
            <div class="content">
                <div class="import-box">
                    <label>âš¡ æ•¸æ“šå¿«é€Ÿè§£æå™¨ (è²¼å…¥å ±è¡¨ç¸½è¨ˆåˆ—)</label>
                    <textarea id="bulkPaste" rows="2" placeholder="è²¼å…¥æ•¸æ“šå¾Œè‡ªå‹•å¡«å…¥æ¬„ä½..." oninput="parseBulkData()"></textarea>
                </div>
                
                <div style="display:grid; grid-template-columns: 2fr 1fr; gap:10px; margin-bottom:10px;">
                    <div><label>å®¢æˆ¶åç¨±</label><input type="text" id="client" placeholder="è¼¸å…¥å®¢æˆ¶åç¨±..." oninput="run()"></div>
                    <div><label style="color:var(--danger)">ğŸ”¥ èŠ±è²»é€²åº¦ (%)</label><input type="text" id="v-progress" placeholder="å¦‚: 85" oninput="run()"></div>
                </div>
                
                <div style="margin-bottom:10px;">
                    <label>æŠ•æ”¾å¹³å°</label>
                    <div class="platform-selector">
                        <label class="platform-item"><input type="checkbox" class="p-check" value="Google PMax" onchange="run()"> Google PMax</label>
                        <label class="platform-item"><input type="checkbox" class="p-check" value="Google GDN" onchange="run()"> Google GDN</label>
                        <label class="platform-item"><input type="checkbox" class="p-check" value="Google KWS" onchange="run()"> Google KWS</label>
                        <label class="platform-item"><input type="checkbox" class="p-check" value="Meta" onchange="
